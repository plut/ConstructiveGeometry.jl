\documentclass{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{unicode,math}
\usepackage[margin=30mm]{geometry}
\newenvironment{eqsplit}{\equation\aligned}{\endaligned\endequation}


\begin{document}
\title{Useful geometric computatoins}


\section{Uniform approximation of a parabolic arc by a polygonal chain}%Â«Â«1
\begin{prop}\label{prop:points}
Let~$ğ’«$ be the parabola with equation $y = f(x) = a/2 + xÂ²/2a$.
Let~$H$ be the hypergeometric function
$H(u) = {}_2F_1(1/4,1/2;\;3/2\;-u^2)$.

Choose real numbers~$s_1$, $s_2$ and an integer~$n â‰¥ 1$
and define, for~$i = 0, â€¦, n$,
$x_i = a H^{-1}((1-i/n) s_1 + (i/n) s_2)$.

Then, for $n$ large enough,
the polygonal line with vertices~$A_i = (x_i, f(x_i))$
lies within a Minkowski distance~$Î´ = \frac{a}{8n^2}
(s_2-s_1)^2+O(n^{-4})$ of the parabola~$ğ’«$.
\end{prop}

\begin{proof}
It is enough to prove this for an individual segment of the polygonal line,
for example the segment $(A_0, A_1)$.
For~$x_0 â‰¤ x â‰¤ x_1$, the distance between a point~$(x, f(x)) âˆˆ ğ’«$
and the segment~$(A_0, A_1)$ is given by the function
% 	the maximum on the interval~$[x_0,x_1]$ of the function
\begin{equation}\begin{split}
g(x)
%  &= \frac{(x_0+x_1)/(2a) x - f(x) + x_0 x_1/(2a) + a/2}{âˆš{1+(x_0+x_1/2a)^2}}\\
 &= \frac{(x_0+x_1) x - 2a f(x) + x_0 x_1 + a^2}{âˆš{(2a)^2+(x_0+x_1)^2}}\\
%  &= \frac{(x_0+x_1) x - a^2 - x^2 + x_0 x_1 + a^2}{âˆš{(2a)^2+(x_0+x_1)^2}}\\
 &= \frac{(x-x_0)(x_1-x)}{âˆš{(2a)^2+(x_0+x_1)^2}}.\\
\end{split}\end{equation}
The maximum value~$Î´_0$ of~$g$ on the interval~$[x_0,x_1]$
is reached for~$x = (x_0+x_1)/2$
and amounts to $Î´_0 = \frac{(x_1-x_0)^2}{4âˆš{(2a)^2+(x_0+x_1)^2}}$.

Let~$G = H^{-1}$ and~$x(t) = a G((1-t) s_1 + t s_2)$.
Then for all~$i = 0,â€¦, n$, $x_i = x(i/n)$
and $x_{i+1} - x_i = x'(i/n)/n + O(1/n^2)$.
Therefore
\begin{equation}
Î´_i = \frac{x'(i/n)^2}{8n^2 âˆš{a^2 + x_i^2}} + O(1/n^4).
\end{equation}

Since $H'(u)^4 = 1/(1+u^2)$,
the inverse~$G$ of~$H$ satisfies the differential equation
$(G')^4 = 1 + G^2$,
and hence $x'(t)^2 = a (s_2 - s_1)^2 âˆš{a^2 + x(t)^2}$.
Accordingly, one finds
\begin{equation}
Î´_i = \frac{a}{8n^2} (s_2-s_1)^2 + O(1/n^4).
\end{equation}
Since this is true for all~$i = 0,â€¦,n-1$, the proposition follows.
\end{proof}


\begin{prop}\label{prop:approx}
The following algorithm approximates the parabola~$ğ’«$
on the interval~$[X_1,X_2]$ within a distance~$â‰¤ Î´ + O(Î´^2)$.
\begin{enumerate}
\item For~$i = 1,2$, define $s_i = H(X_i/a)$.
\item Let~$n â‰¥ \abs{s_2-s_1} âˆš{a/(8Î´)}$.
\item Define the points~$(x_i=a H^{-1}(s_1 + \frac{i}{n}(s_2-s_1), f(x_i))$
as in Prop.~\ref{prop:points}.
\end{enumerate}
\end{prop}


% \section{Arc length of an Archimedean spiral (wrapped line segment)}%Â«Â«1
% 
% Let~$F$ be the transformation on~$â„^2$ defined by
% $F(x,y) = (x \cos(y/x), x \sin(y/x)$.
% 
% \begin{prop}
% Let~$S = (p_0, p_1)$ be a line segment, with $p_i = (x_i, y_i)$,
% such that $0 < x_0 < x_1$.
% Let~$a = x_0 - x_1$, $D = x_0 y_1 - y_0 x_1$,
% and $z_i = D+âˆš{a^2 x_i^2 + D^2}$.
% Then the arc length of the image curve~$F(S)$ is
% \[ \begin{cases}
%   \frac{D}{a} \log \frac{x_1 z_0}{x_0 z_1}
% 	+ a \pa{\frac{x_1^2}{z_1}-\frac{x_0^2}{z_0}}&
% 	\text{if $x_0 â‰ Â x_1$;}\\
% 	x_0 \abs{y_0 - y_1} &\text{if $x_0 = x_1$.}\end{cases}
% \]
% \end{prop}
% \begin{proof}
% The segment is parametrized as $p(t) = (1-t) p_0 + p_1
%  = (t (x_1-x_0) + x_0, t (y_1 - y_0) + y_0).
%  = (a t +  b, c t + d)$
% with $a = (x_1-x_0)$, $b = x_0$, $c = (y_1 - y_0)$, $d = y_0$.
% In complex notation, one finds
% $F(p(t)) = (a t + b) \exp(i \frac{ct+d}{at+b})$ and hence
% \begin{eqsplit} F(p(t))'
% &= a e^{iâ€¦} + (a t + b) i \frac{bc-ad}{(at+b)^2} e^{iâ€¦} \\
% &= \pa{a + i \frac{bc - ad}{at + b}} \exp\pa{i \frac{ct+d}{at+b}};\\
% \abs{F'(p(t))}
% &= âˆš{a^2 + \frac{(ad-bc)^2}{(at+b)^2}}.
% \end{eqsplit}
% The arc length is therefore
% \begin{eqsplit}
% &= âˆ«_0^1 \abs{F'(p(t))} dt
% &= âˆ«_0^1 âˆš{a^2 + \frac{(ad-bc)^2}{(at+b)^2}} dt\\
% &= âˆ«_0^1 âˆš{a^2(at+b)^2 + (ad-bc)^2} \;\frac{dt}{at+b} \\
% % &= a âˆ«_0^1 âˆš{(at+b)^2 + (d-bc/a)^2} \;\frac{dt}{at+b} \\
% \end{eqsplit}
% Define $s = (at+b)/(D+âˆš{a^2(at+b)^2+D^2})$,
% so that $t = -b/a+2sD/(a^2(1-s^2))$,
% $âˆš{(at+b)^2+D^2/a^2} = D\frac{1+s^2}{1-s^2}$,
% and $dt = 2D/a^2 \frac{1+s^2}{(1-s^2)^2} ds$.
% Then
% \begin{eqsplit}
% G(t) = âˆ« \abs{F'(p(t))} dt
% &= \frac{D}{a} âˆ« \pa{\frac{1+s^2}{1-s^2}}^2 \frac{ds}{s}\\
% &= \frac{D}{a} âˆ« \pa{\frac 1s +\frac{1}{(s-1)^2} - \frac{1}{(s+1)^2}} ds\\
% &= \frac{D}{a} \pa{\log s + \frac{2}{1-s^2}}\\
% &= \frac{D}{a} \pa{\log \frac{at+b}{D+âˆš{a^2(at+b)^2+D^2}}
%  + 2 \frac{(D+âˆš{a^2(at+b)^2+D^2})^2}{(D+âˆš{a^2(at+b)^2+D^2})^2-(at+b)^2}}\\
% &= \frac{D}{a} \pa{\log \frac{at+b}{D+âˆš{â€¦}}
%  + 2 + \frac{a^2}{D}\frac{(at+b)^2}{D+âˆš{â€¦}}}\\
% &= \frac{D}{a} \log \frac{at+b}{D+âˆš{a^2(at+b)^2+D^2}} + \frac{2D}{a}
%  + a \frac{(at+b)^2}{D+âˆš{a^2(at+b)^2+D^2}}
% \end{eqsplit}
% The primitive~$G-2D/a$ takes the following values:
% \begin{eqsplit}
% G(0)
% &= \frac{D}{a} \log \frac{x_0}{D+âˆš{a^2 x_0^2 + D^2}}
%  + \frac{a x_0^2}{D+âˆš{a^2 x_0^2+D^2}}\\
% G(1)
% &= \frac{D}{a} \log \frac{x_1}{D+âˆš{a^2 x_1^2+D^2}}
%  + \frac{a x_1^2}{D+âˆš{a^2 x_1^2+D^2}}\\
% \end{eqsplit}
% This concludes the case where~$a â‰ Â 0$. The other case is trivial.
% \end{proof}
% % Â»Â»1
% \section{Arc length of wrapped segment (correct)}%Â«Â«1
% Let~$F(x,y,z) = ((x+r) \cos(y/r), (x+r) \sin(y/r), z)$.
% \begin{prop}
% Let~$S = (p_0, p_1)$ be a line segment, with $p_i = (x_i, y_i, z_i)$.
% Define~$a = x_0 - x_1$ and~$c = z_0 - z_1$,
% and $Î»_i = âˆš{b^2 x_i^2/r^2 + a^2 + c^2}$.
% If $a â‰  0$ and $b â‰ Â 0$ then the arc length of the image curve~$F(S)$ is
% \[
%   \frac{1}{2a}(Î»_1 x_1 - Î»_0 x_0)
% + \frac{a^2 b^2+c^2 r^2}{2a b r} \log \frac{b x_1 + r Î»_1}{b x_0 + r Î»_0}.
% \]
% If $a = 0$ or~$b = 0$ then this arc length is $âˆš{a^2 + b^2 x_0^2/r^2 + c^2}$.
% \end{prop}
% The segment is parametrized as
% $p(t) = (1-t) p_0 + p_1
%  = (t(x_1-x_0) + x_0, t (y_1 - y_0) + y_0, t (z_1 - z_0) + z_0)
%  = (a t + x_0, b t + y_0, c t + z_0)$.
% \begin{eqsplit}
% F(p(t))
% &= ((a t+x_0+r) \cos \frac{b t+y_0}{r}, (at+x_0+r)\sin\frac{bt+y_0}{r},
% ct+z_0) \\
% F(p(t))'
% &= (a \cos Ï†(t) - x(t)b/r \sin Ï†(t) , a \sin Ï†(t) + x(t)b/r \cos Ï†(t), c) \\
% \norm{F(p(t))'}
% &= âˆš{a^2 + (at+x_0)^2 b^2/r^2 + c^2}
% \end{eqsplit}
% Using $âˆ« âˆš{(Î± t+Î²)^2+Î³^2} d t = \frac{Î± t+Î²}{2 Î±} âˆš{â€¦}
%   + \frac{Î³^2}{2 Î±} \log(Î± t+Î²+âˆš{â€¦})$
% with $Î± = ab/r$, $Î²=x_0 b/r$, $Î³^2 = a^2+c^2$:
% \begin{eqsplit}
% âˆ« \norm{F(p(t))'} dt
% &= \frac{(b/r)(a t+x_0)}{2ab/r} âˆš{â€¦}
%   + \frac{a^2 b^2/r^2+c^2}{2ab/r} \log((b/r)(at+x_0)+âˆš{(at+b)^2+a^2+c^2})\\
% &= \frac{x(t)}{2a} âˆš{b^2 x(t)^2/r^2+a^2+c^2}
%   + \frac{a^2 b^2+c^2 r^2}{2a b r} \log(b x(t)/r+âˆš{b^2 x(t)^2/r^2+a^2+c^2})\\
% \end{eqsplit}
% % Define $q = âˆš{a^2+e^2}$ and~$s = (at+b)/(q+âˆš{q^2+(at+b)^2})$; then
% % $t = -b/a+2sq/a(1-s^2)$, $âˆš{q^2+(at+b)^2} = q(1+s^2)/(1-s^2)$,
% % and $dt = 2q/a (1+s^2)/(1-s^2)^2$.
% % Thus the arc length~$L$ is
% % \begin{eqsplit}
% % âˆ«_0^1 |F(p(t))'|\;dt
% % &= âˆ«_0^1 âˆš{q^2+(at+b)^2}\; dt \\
% % &= \frac{2 q^2}{a} âˆ« \frac{(1+s^2)^2}{(1-s^2)^3}\;ds \\
% % &= \frac{2 q^2}{a} âˆ«
% % \pa{\frac{1/4}{s+1}-\frac{1/4}{s-1}+\frac{s^4+6s^2+1}{2(1-s^2)^3}}\; ds\\
% % &= \frac{2 q^2}{a} \pa{ \frac 14 \log \frac{s+1}{s-1}
% %   + \frac 12 \frac{s(s^2+1)}{(1-s^2)^2}}\\
% % &= \frac{2 q^2}{a} \pa{\frac 14 \log \frac{q+b+u}{q-b+u}
% %  + \frac 12 
% % \end{eqsplit}
% 
% % Â»Â»1
\section{Sagitta of wrapped segment}%Â«Â«1
Let~$F(x,y,z) = ((x+r) \cos(y/r), (x+r) \sin(y/r))$.
\begin{prop}
Let~$S = (p_0, p_1)$ be a line segment, with $p_i = (x_i, y_i)$.
% Define~$a = x_0 - x_1$ and~$c = z_0 - z_1$,
% and $Î»_i = âˆš{b^2 x_i^2/r^2 + a^2 + c^2}$.
The \emph{sagitta} of~$F(S)$ is the Minkowski distance
between the image curve $F(S)$ and the straight segment $(F(p_0),F(p_1))$.

\end{prop}
Distance in polar coordinates $(r e^{iÎ¸})$:
\begin{eqsplit}
\norm{r_0 e^{iÎ¸_0} - r_1 e^{iÎ¸_1}}^2
&= \norm{r_0 e^{iÎ¸_0}}^2 + \norm{r_1 e^{i Î¸_1}}^2
  - 2 (r_0 e^{iÎ¸_0})â‹…(r_1 e^{i Î¸_1}) \\
&= r_0^2 + r_1^2 - 2 r_0 r_1 \cos(Î¸_0 - Î¸_1).
\end{eqsplit}
Let~$Î£ = (F(p_0), F(p_1))$,
then $â„“(Î£)^2 = (x_0+r)^2 + (x_1+r)^2 - 2 (x_0+r)(x_1+r) \cos((y_0-y_1)/r)$.

The segment $(p_0, p_1)$ is parametrized as
$p(t) = (1-t) p_0 + p_1
 = (t(x_1-x_0) + x_0, t (y_1 - y_0) + y_0)
 = (a t + x_0, b t + y_0)$,
so that
$F(p(t)) = (Î¾(t), Î·(t)) = ((r+x(t)) \cos(y(t)/r), (r+x(t)) \sin(y(t)/r))$.
The squared distance of a point $F(p(t))$ to the
segment~$Î£=(F(p_0),F(p_1))$
is
\begin{eqsplit}
Î´(t)^2
&= \frac{1}{\norm{Î£}^2} \chev{F(p(t))-F(p_0),F(p_1)-F(p_0)}^2\\
&= \frac{(x(t)-x_0)(y_1 -y_0) - (y(t) - y_0)(x_1 - x_0)}{\norm{Î£}^2}\\
\end{eqsplit}

\end{document}
% vim: fdm=marker fmr=Â«Â«,Â»Â»:
